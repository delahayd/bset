# $Id$

SHELL:=/bin/bash
CVC4=cvc4
TIMEOUT=3000
BFILES=$(shell ls *.smt2)
BRESFILES=$(BFILES:%.smt2=%.res)

test: $(BRESFILES)

analyze: $(BRESFILES)
	-@grep -l "unsat" *.res.cvc4 | sort -V > cvc4.valid; \
	grep -l "unknow" *.res.cvc4 | sort -V > cvc4.unknown

summary: analyze
	-@wc -l cvc4.*

clean:
	rm -f *~ *.res*

.SUFFIXES: .smt2 .res

%.res: %.smt2
	-@echo -n "[CVC4] **** Testing file $<: "; touch $@; \
        $(CVC4) --tlimit=$(TIMEOUT) $< > $@.cvc4; \
        tmp=`cat $@.cvc4 | grep "unsat"`; \
        if test -n "$$tmp"; then echo -e "\033[32mValid\033[39m"; \
        else echo -e "\033[31mFail\033[39m"; fi 
